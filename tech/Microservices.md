

# Принципы построения микросервисов

При разделении приложения на микросервисы важно следовать определённым принципам, чтобы система оставалась поддерживаемой, масштабируемой и эффективной. Вот ключевые принципы, которые следует учитывать:

Следуя этим принципам, вы можете разбить своё приложение на микросервисы таким образом, чтобы максимально использовать преимущества микросервисной архитектуры, минимизируя при этом потенциальные недостатки, такие как повышенная сложность и операционные накладные расходы.

## Принцип единственной ответственности

Каждый микросервис должен фокусироваться на конкретной бизнес-возможности или функции.
Это повышает поддерживаемость и делает сервисы легче для понимания и управления.

## Ограниченные контексты (Domain-Driven Design)

Используйте предметно-ориентированное проектирование для идентификации отдельных областей (ограниченных контекстов) внутри вашей доменной модели.
Соотнесите микросервисы с этими контекстами, чтобы обеспечить инкапсуляцию связанных данных и поведения.

## Слабая связанность и высокая когезия

**Слабая связанность** (англ. `low coupling`) - cервисы должны иметь минимальные зависимости друг от друга, чтобы снизить влияние изменений.

**Высокая когезия** (англ. `high cohesion`) - группируйте связанные функции внутри одного сервиса, чтобы сохранить их целостность.


## Ориентация на бизнес-возможности (англ. `Business Capability Orientation`)

Организуйте микросервисы вокруг бизнес-возможностей, а не технических слоёв (например, пользовательский интерфейс, бизнес-логика, доступ к данным).
Это обеспечивает предоставление сервисами полной функциональности от начала до конца.

## Независимая развертываемость
Проектируйте сервисы так, чтобы их можно было разрабатывать, тестировать, развертывать и масштабировать независимо.

Это снижает риски развертывания и позволяет быстрее проводить итерации.

## Владение данными и их хранение:

Каждый микросервис должен владеть своей базой данных и управлять своими данными, чтобы предотвратить тесную связанность через общие базы данных.
Это способствует инкапсуляции данных и автономности сервисов.

## Явные контракты сервисов (API):

Определите чёткие и стабильные интерфейсы для взаимодействия между сервисами.
Используйте хорошо определённые API для управления коммуникацией и обеспечения обратной совместимости при обновлении сервисов.

## Асинхронная коммуникация:

Предпочитайте асинхронное обмен сообщениями для межсервисного взаимодействия, чтобы улучшить масштабируемость и устойчивость.
Это помогает разъединить сервисы и более эффективно обрабатывать изменяющиеся нагрузки.

## Избегайте преждевременной оптимизации (правильный размер сервисов):

Избегайте слишком детального разделения сервисов с самого начала; начните с более крупных сервисов и при необходимости рефакторьте.
Чрезмерно гранулированные сервисы могут привести к повышенной сложности и накладным расходам.

## Организационное соответствие (закон Конуэя):

Соотнесите границы микросервисов со структурой команд, чтобы усилить владение и ответственность.
Кросс-функциональные команды могут управлять сервисами от разработки до развертывания.

## Устойчивость и изоляция отказов:

Проектируйте сервисы так, чтобы они могли справляться с отказами без влияния на всю систему.
Реализуйте прерыватели цепи, повторные попытки и тайм-ауты для управления сбоями в межсервисной коммуникации.

## Независимость технологий и платформ:

Позвольте сервисам использовать наиболее подходящие технологии для их специфических потребностей.
Эта гибкость может оптимизировать производительность и использовать специализированные инструменты.

## Соображения масштабируемости:

Идентифицируйте сервисы, которые требуют независимого масштабирования на основе нагрузки.
Разделите сервисы для оптимизации использования ресурсов и производительности.

## Мониторинг и логирование:

Реализуйте централизованный мониторинг и логирование для отслеживания состояния и производительности сервисов.
Обеспечьте видимость межсервисной коммуникации для устранения неполадок и анализа.

## Границы безопасности:

Рассматривайте каждый сервис как границу безопасности.
Обеспечьте аутентификацию и авторизацию на уровне сервиса для повышения безопасности.
Соответствие нормативным требованиям и чувствительность данных:

Учитывайте юридические и нормативные требования при определении границ сервисов.
Изолируйте сервисы, обрабатывающие конфиденциальные данные, чтобы упростить управление соответствием.

## Эволюционный дизайн:

Будьте готовы, что границы сервисов могут изменяться со временем, а это значит, что придётся рефакторить и развивать архитектуру по мере углубления понимания домена.
